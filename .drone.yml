kind: pipeline
name: default

steps:
- name: build and test
  image: golang
  commands:
  - go get github.com/cuttle-ai/web-starter && cd $GOPATH/src/github.com/cuttle-ai/web-starter && go get ./... && go get github.com/schrej/godacov && export PAT
  - go build ./...
  - go test -coverprofile=coverage.out ./...

- name: codacy
  image: plugins/codacy
  settings:
    token:
      from_secret: codacy-api-token